---
import Layout from '../layouts/Layout.astro';

export const prerender = false;

// Use Eastern timezone for date
const easternDate = new Date().toLocaleString('en-US', { timeZone: 'America/New_York' });
const nowEastern = new Date(easternDate);
const today = nowEastern.toISOString().split('T')[0];

// Goals
const goals = {
  weight: { start: 250, target: 210, label: 'Weight' },
  waist: { start: 36, target: 32, label: 'Waist' },
  arms: { start: 14, target: 16, label: 'Arms' }
};
---

<Layout title="Body Metrics" activeNav="metrics">
  <div class="space-y-6">

    <!-- Header -->
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl md:text-3xl font-bold gradient-text">Body Metrics</h1>
        <p class="text-[var(--text-muted)] text-sm mt-1">Track your transformation journey</p>
      </div>
      <div class="text-right">
        <div class="text-xs text-[var(--text-muted)]">Target</div>
        <div class="text-lg font-bold text-[var(--brand-green)]">210 lbs</div>
      </div>
    </div>

    <!-- Current Stats Grid -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <div class="card card-glow text-center p-5">
        <div class="text-3xl font-black gradient-text" id="current-weight">--</div>
        <div class="text-xs text-[var(--text-muted)] mt-1">Weight (lbs)</div>
        <div class="text-xs mt-2" id="weight-change">
          <span class="text-[var(--brand-green)]">--</span>
        </div>
      </div>
      <div class="card card-glow text-center p-5">
        <div class="text-3xl font-black text-[var(--brand-cyan)]" id="current-waist">--</div>
        <div class="text-xs text-[var(--text-muted)] mt-1">Waist (in)</div>
        <div class="text-xs mt-2" id="waist-change">
          <span class="text-[var(--brand-green)]">--</span>
        </div>
      </div>
      <div class="card card-glow text-center p-5">
        <div class="text-3xl font-black text-[var(--brand-green)]" id="current-bodyfat">--</div>
        <div class="text-xs text-[var(--text-muted)] mt-1">Body Fat %</div>
        <div class="text-xs mt-2" id="bodyfat-change">
          <span class="text-[var(--text-muted)]">--</span>
        </div>
      </div>
      <div class="card card-glow text-center p-5">
        <div class="text-3xl font-black text-[var(--brand-purple)]" id="current-arms">--</div>
        <div class="text-xs text-[var(--text-muted)] mt-1">Arms (in)</div>
        <div class="text-xs mt-2" id="arms-change">
          <span class="text-[var(--brand-green)]">--</span>
        </div>
      </div>
    </div>

    <!-- Charts Row -->
    <div class="grid md:grid-cols-2 gap-6">

      <!-- Weight Trend Chart -->
      <div class="card p-5">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-[var(--text-primary)]">Weight Trend</h3>
          <select id="weight-range" class="text-xs bg-[var(--bg-glass)] border border-[var(--border-color)] rounded-lg px-2 py-1 text-[var(--text-secondary)]">
            <option value="30">30 Days</option>
            <option value="90">90 Days</option>
            <option value="all">All Time</option>
          </select>
        </div>
        <div id="weight-chart" class="h-64"></div>
      </div>

      <!-- Goal Progress Bars -->
      <div class="card p-5">
        <h3 class="font-semibold text-[var(--text-primary)] mb-4">Goal Progress</h3>
        <div id="goals-chart" class="h-64"></div>
      </div>
    </div>

    <!-- Log New Metrics -->
    <div class="card p-5">
      <h3 class="font-semibold text-[var(--text-primary)] mb-4 flex items-center gap-2">
        <span class="text-lg">üìè</span>
        Log Measurements
      </h3>
      <form id="metrics-form" class="space-y-4">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Date</label>
            <input type="date" id="metric-date" value={today} class="input-field" />
          </div>
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Weight (lbs)</label>
            <input type="number" step="0.1" id="metric-weight" placeholder="250" class="input-field" />
          </div>
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Waist (in)</label>
            <input type="number" step="0.25" id="metric-waist" placeholder="34" class="input-field" />
          </div>
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Neck (in)</label>
            <input type="number" step="0.25" id="metric-neck" placeholder="16" class="input-field" />
          </div>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Chest (in)</label>
            <input type="number" step="0.25" id="metric-chest" placeholder="42" class="input-field" />
          </div>
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Arms (in)</label>
            <input type="number" step="0.25" id="metric-arms" placeholder="15" class="input-field" />
          </div>
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Thighs (in)</label>
            <input type="number" step="0.25" id="metric-thighs" placeholder="24" class="input-field" />
          </div>
          <div>
            <label class="block text-xs text-[var(--text-muted)] mb-1">Notes</label>
            <input type="text" id="metric-notes" placeholder="Optional" class="input-field" />
          </div>
        </div>
        <div class="flex items-center gap-4">
          <button type="submit" class="btn-primary">
            Save Measurements
          </button>
          <div id="bodyfat-result" class="text-sm text-[var(--brand-green)]"></div>
        </div>
      </form>
    </div>

    <!-- Measurements Radar Chart -->
    <div class="card p-5">
      <h3 class="font-semibold text-[var(--text-primary)] mb-4">Measurements Comparison</h3>
      <div class="grid md:grid-cols-2 gap-6 items-center">
        <div id="radar-chart" class="h-72"></div>
        <div class="space-y-4">
          <div class="flex items-center gap-3">
            <div class="w-3 h-3 rounded-full bg-[var(--brand-orange)]"></div>
            <span class="text-sm text-[var(--text-secondary)]">Current Measurements</span>
          </div>
          <div class="flex items-center gap-3">
            <div class="w-3 h-3 rounded-full bg-[var(--brand-cyan)] opacity-50"></div>
            <span class="text-sm text-[var(--text-secondary)]">Goal Measurements</span>
          </div>
          <div class="mt-4 p-4 rounded-xl bg-[var(--bg-glass)] border border-[var(--border-color)]">
            <div class="text-xs text-[var(--text-muted)] mb-2">Progress Summary</div>
            <div class="text-sm text-[var(--text-secondary)]" id="progress-summary">
              Loading progress data...
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- History Table -->
    <div class="card p-5">
      <h3 class="font-semibold text-[var(--text-primary)] mb-4">Measurement History</h3>
      <div id="history-table" class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="text-left text-[var(--text-muted)] border-b border-[var(--border-color)]">
              <th class="pb-3 font-medium">Date</th>
              <th class="pb-3 font-medium">Weight</th>
              <th class="pb-3 font-medium">Waist</th>
              <th class="pb-3 font-medium">Body Fat</th>
              <th class="pb-3 font-medium">Arms</th>
              <th class="pb-3 font-medium">Chest</th>
            </tr>
          </thead>
          <tbody id="history-body" class="text-[var(--text-secondary)]">
            <tr><td colspan="6" class="text-center py-8 text-[var(--text-muted)]">Loading...</td></tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</Layout>

<!-- ApexCharts -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<script define:vars={{ goals }}>
  // Theme-aware colors
  function getChartColors() {
    const isDark = document.documentElement.getAttribute('data-theme') !== 'light';
    return {
      text: isDark ? '#94a3b8' : '#64748b',
      grid: isDark ? 'rgba(148, 163, 184, 0.1)' : 'rgba(100, 116, 139, 0.1)',
      background: 'transparent',
      orange: '#ff6b35',
      orangeLight: 'rgba(255, 107, 53, 0.2)',
      cyan: '#00d4ff',
      cyanLight: 'rgba(0, 212, 255, 0.2)',
      green: '#00ff88',
      greenLight: 'rgba(0, 255, 136, 0.2)',
      purple: '#a855f7'
    };
  }

  let weightChart, compositionChart, radarChart;
  let metricsData = [];

  // Animated counter
  function animateValue(element, target, suffix = '') {
    const duration = 1000;
    const startTime = performance.now();
    const startValue = 0;

    function update(currentTime) {
      const elapsed = currentTime - startTime;
      const progress = Math.min(elapsed / duration, 1);
      const easeOut = 1 - Math.pow(1 - progress, 3);
      const current = startValue + (target - startValue) * easeOut;

      if (typeof target === 'number' && !isNaN(target)) {
        element.textContent = (Math.round(current * 10) / 10) + suffix;
      }

      if (progress < 1) {
        requestAnimationFrame(update);
      }
    }

    requestAnimationFrame(update);
  }

  // Initialize Weight Trend Chart
  function initWeightChart(data) {
    const colors = getChartColors();
    const chartData = data.filter(m => m.weight).map(m => ({
      x: new Date(m.date).getTime(),
      y: m.weight
    })).reverse();

    const options = {
      series: [{
        name: 'Weight',
        data: chartData
      }],
      chart: {
        type: 'area',
        height: 256,
        background: colors.background,
        toolbar: { show: false },
        animations: {
          enabled: true,
          easing: 'easeinout',
          speed: 800
        }
      },
      stroke: {
        curve: 'smooth',
        width: 3,
        colors: [colors.orange]
      },
      fill: {
        type: 'gradient',
        gradient: {
          shadeIntensity: 1,
          opacityFrom: 0.5,
          opacityTo: 0.1,
          stops: [0, 100],
          colorStops: [{
            offset: 0,
            color: colors.orange,
            opacity: 0.4
          }, {
            offset: 100,
            color: colors.orange,
            opacity: 0.05
          }]
        }
      },
      grid: {
        borderColor: colors.grid,
        strokeDashArray: 3
      },
      xaxis: {
        type: 'datetime',
        labels: {
          style: { colors: colors.text, fontSize: '11px' }
        },
        axisBorder: { show: false },
        axisTicks: { show: false }
      },
      yaxis: {
        labels: {
          style: { colors: colors.text, fontSize: '11px' },
          formatter: (val) => val + ' lbs'
        }
      },
      tooltip: {
        theme: 'dark',
        x: { format: 'MMM dd, yyyy' },
        y: { formatter: (val) => val + ' lbs' }
      },
      annotations: {
        yaxis: [{
          y: 210,
          borderColor: colors.green,
          borderWidth: 2,
          strokeDashArray: 5,
          label: {
            text: 'Goal: 210 lbs',
            style: {
              color: '#fff',
              background: colors.green,
              fontSize: '10px',
              padding: { left: 5, right: 5, top: 2, bottom: 2 }
            }
          }
        }]
      },
      markers: {
        size: 0,
        hover: { size: 6 }
      }
    };

    if (weightChart) weightChart.destroy();
    weightChart = new ApexCharts(document.getElementById('weight-chart'), options);
    weightChart.render();
  }

  // Initialize Goals Horizontal Bar Chart - Shows start, current, goal clearly
  function initGoalsChart(latest) {
    const colors = getChartColors();

    // For weight/waist: lower is better (goal < start)
    // For arms: higher is better (goal > start)
    const currentWeight = latest?.weight || goals.weight.start;
    const currentWaist = latest?.waist || goals.waist.start;
    const currentArms = latest?.arms || goals.arms.start;

    const options = {
      series: [{
        name: 'Progress',
        data: [
          {
            x: 'Weight',
            y: [goals.weight.target, currentWeight],
            goals: [{ name: 'Start', value: goals.weight.start, strokeColor: colors.text, strokeWidth: 2 }]
          },
          {
            x: 'Waist',
            y: [goals.waist.target, currentWaist],
            goals: [{ name: 'Start', value: goals.waist.start, strokeColor: colors.text, strokeWidth: 2 }]
          },
          {
            x: 'Arms',
            y: [goals.arms.start, currentArms],
            goals: [{ name: 'Goal', value: goals.arms.target, strokeColor: colors.green, strokeWidth: 3 }]
          }
        ]
      }],
      chart: {
        type: 'rangeBar',
        height: 256,
        background: 'transparent',
        toolbar: { show: false },
        animations: {
          enabled: true,
          easing: 'easeinout',
          speed: 800
        }
      },
      plotOptions: {
        bar: {
          horizontal: true,
          borderRadius: 6,
          barHeight: '60%',
          rangeBarGroupRows: true
        }
      },
      colors: [colors.orange, colors.cyan, colors.purple],
      fill: {
        type: 'gradient',
        gradient: {
          shade: 'dark',
          type: 'horizontal',
          shadeIntensity: 0.3,
          gradientToColors: [colors.green],
          stops: [0, 100]
        }
      },
      xaxis: {
        type: 'numeric',
        labels: {
          style: { colors: colors.text, fontSize: '11px' },
          formatter: (val) => Math.round(val)
        },
        axisBorder: { show: false },
        axisTicks: { show: false }
      },
      yaxis: {
        labels: {
          style: { colors: colors.text, fontSize: '12px', fontWeight: 600 }
        }
      },
      grid: {
        borderColor: colors.grid,
        strokeDashArray: 3,
        xaxis: { lines: { show: true } },
        yaxis: { lines: { show: false } }
      },
      tooltip: {
        theme: 'dark',
        custom: function({ seriesIndex, dataPointIndex, w }) {
          const data = w.config.series[0].data[dataPointIndex];
          const label = data.x;
          const current = data.y[1];
          const target = data.y[0];

          let startVal, goalVal, unit, direction;
          if (label === 'Weight') {
            startVal = goals.weight.start;
            goalVal = goals.weight.target;
            unit = ' lbs';
            direction = 'down';
          } else if (label === 'Waist') {
            startVal = goals.waist.start;
            goalVal = goals.waist.target;
            unit = '"';
            direction = 'down';
          } else {
            startVal = goals.arms.start;
            goalVal = goals.arms.target;
            unit = '"';
            direction = 'up';
          }

          const progress = direction === 'down'
            ? ((startVal - current) / (startVal - goalVal) * 100)
            : ((current - startVal) / (goalVal - startVal) * 100);

          return `<div style="padding: 12px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px;">
            <div style="font-weight: bold; margin-bottom: 8px;">${label}</div>
            <div style="color: var(--text-muted); font-size: 11px;">Started: ${startVal}${unit}</div>
            <div style="color: var(--brand-orange); font-weight: bold;">Current: ${current}${unit}</div>
            <div style="color: var(--brand-green); font-size: 11px;">Goal: ${goalVal}${unit}</div>
            <div style="margin-top: 8px; color: var(--brand-cyan);">${Math.round(Math.max(0, Math.min(100, progress)))}% complete</div>
          </div>`;
        }
      },
      legend: { show: false },
      dataLabels: {
        enabled: true,
        formatter: function(val, { dataPointIndex, w }) {
          const data = w.config.series[0].data[dataPointIndex];
          const current = data.y[1];
          const label = data.x;
          const unit = label === 'Weight' ? ' lbs' : '"';
          return current + unit;
        },
        style: {
          colors: ['#fff'],
          fontSize: '12px',
          fontWeight: 'bold'
        }
      }
    };

    if (compositionChart) compositionChart.destroy();
    compositionChart = new ApexCharts(document.getElementById('goals-chart'), options);
    compositionChart.render();
  }

  // Initialize Radar Chart
  function initRadarChart(latest) {
    const colors = getChartColors();

    const currentData = [
      latest?.weight || 0,
      latest?.waist || 0,
      latest?.chest || 0,
      latest?.arms || 0,
      latest?.thighs || 0
    ];

    const goalData = [210, 32, 44, 16, 26];

    // Normalize to 0-100 scale for radar
    const normalize = (val, max) => Math.min(100, (val / max) * 100);
    const maxVals = [300, 50, 60, 25, 35];

    const options = {
      series: [{
        name: 'Current',
        data: currentData.map((v, i) => normalize(v, maxVals[i]))
      }, {
        name: 'Goal',
        data: goalData.map((v, i) => normalize(v, maxVals[i]))
      }],
      chart: {
        type: 'radar',
        height: 288,
        background: 'transparent',
        toolbar: { show: false }
      },
      colors: [colors.orange, colors.cyan],
      stroke: {
        width: 2,
        colors: [colors.orange, colors.cyan]
      },
      fill: {
        opacity: [0.3, 0.1]
      },
      markers: {
        size: 4,
        colors: [colors.orange, colors.cyan],
        strokeColors: [colors.orange, colors.cyan],
        strokeWidth: 2
      },
      xaxis: {
        categories: ['Weight', 'Waist', 'Chest', 'Arms', 'Thighs'],
        labels: {
          style: {
            colors: [colors.text, colors.text, colors.text, colors.text, colors.text],
            fontSize: '11px'
          }
        }
      },
      yaxis: {
        show: false
      },
      legend: {
        show: false
      },
      plotOptions: {
        radar: {
          polygons: {
            strokeColors: colors.grid,
            connectorColors: colors.grid,
            fill: {
              colors: ['transparent']
            }
          }
        }
      }
    };

    if (radarChart) radarChart.destroy();
    radarChart = new ApexCharts(document.getElementById('radar-chart'), options);
    radarChart.render();
  }

  // Load metrics data
  async function loadMetrics() {
    try {
      const res = await fetch('/api/metrics?limit=90');
      const data = await res.json();
      metricsData = data.metrics || [];

      if (metricsData.length > 0) {
        const latest = metricsData[0];
        const previous = metricsData.length > 1 ? metricsData[1] : null;

        // Update current stats with animation
        if (latest.weight) {
          animateValue(document.getElementById('current-weight'), latest.weight);
          if (previous?.weight) {
            const diff = latest.weight - previous.weight;
            const el = document.getElementById('weight-change');
            el.innerHTML = diff <= 0
              ? `<span class="text-[var(--brand-green)]">${diff.toFixed(1)} lbs</span>`
              : `<span class="text-red-400">+${diff.toFixed(1)} lbs</span>`;
          }
        }

        if (latest.waist) {
          animateValue(document.getElementById('current-waist'), latest.waist, '"');
          if (previous?.waist) {
            const diff = latest.waist - previous.waist;
            const el = document.getElementById('waist-change');
            el.innerHTML = diff <= 0
              ? `<span class="text-[var(--brand-green)]">${diff.toFixed(1)}"</span>`
              : `<span class="text-red-400">+${diff.toFixed(1)}"</span>`;
          }
        }

        if (latest.body_fat) {
          animateValue(document.getElementById('current-bodyfat'), latest.body_fat, '%');
          if (previous?.body_fat) {
            const diff = latest.body_fat - previous.body_fat;
            const el = document.getElementById('bodyfat-change');
            el.innerHTML = diff <= 0
              ? `<span class="text-[var(--brand-green)]">${diff.toFixed(1)}%</span>`
              : `<span class="text-red-400">+${diff.toFixed(1)}%</span>`;
          }
        }

        if (latest.arms) {
          animateValue(document.getElementById('current-arms'), latest.arms, '"');
          if (previous?.arms) {
            const diff = latest.arms - previous.arms;
            const el = document.getElementById('arms-change');
            el.innerHTML = diff >= 0
              ? `<span class="text-[var(--brand-green)]">+${diff.toFixed(1)}"</span>`
              : `<span class="text-red-400">${diff.toFixed(1)}"</span>`;
          }
        }

        // Initialize charts
        initWeightChart(metricsData);
        initGoalsChart(latest);
        initRadarChart(latest);

        // Update progress summary
        const startWeight = 250;
        const totalLost = latest.weight ? startWeight - latest.weight : 0;
        const remaining = latest.weight ? latest.weight - 210 : 40;
        document.getElementById('progress-summary').innerHTML = `
          <div class="space-y-1">
            <div><span class="text-[var(--brand-green)] font-semibold">${totalLost.toFixed(1)} lbs</span> lost from starting weight</div>
            <div><span class="text-[var(--brand-orange)] font-semibold">${remaining.toFixed(1)} lbs</span> to reach goal</div>
          </div>
        `;
      }

      // Populate history table
      const tbody = document.getElementById('history-body');
      if (metricsData.length > 0) {
        tbody.innerHTML = metricsData.slice(0, 15).map((m) => `
          <tr class="border-b border-[var(--border-color)] hover:bg-[var(--bg-glass)] transition-colors">
            <td class="py-3">${new Date(m.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</td>
            <td class="py-3 font-medium">${m.weight || '-'}</td>
            <td class="py-3">${m.waist ? m.waist + '"' : '-'}</td>
            <td class="py-3">${m.body_fat ? m.body_fat + '%' : '-'}</td>
            <td class="py-3">${m.arms ? m.arms + '"' : '-'}</td>
            <td class="py-3">${m.chest ? m.chest + '"' : '-'}</td>
          </tr>
        `).join('');
      } else {
        tbody.innerHTML = '<tr><td colspan="6" class="text-center py-8 text-[var(--text-muted)]">No measurements yet. Log your first entry above!</td></tr>';
      }

    } catch (err) {
      console.error('Failed to load metrics:', err);
    }
  }

  // Form submission
  document.getElementById('metrics-form')?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const data = {
      date: document.getElementById('metric-date').value,
      weight: parseFloat(document.getElementById('metric-weight').value) || null,
      waist: parseFloat(document.getElementById('metric-waist').value) || null,
      neck: parseFloat(document.getElementById('metric-neck').value) || null,
      chest: parseFloat(document.getElementById('metric-chest').value) || null,
      arms: parseFloat(document.getElementById('metric-arms').value) || null,
      thighs: parseFloat(document.getElementById('metric-thighs').value) || null,
      notes: document.getElementById('metric-notes').value || null
    };

    try {
      const res = await fetch('/api/metrics', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      const result = await res.json();

      if (res.ok) {
        if (result.body_fat) {
          document.getElementById('bodyfat-result').textContent = `Calculated body fat: ${result.body_fat}%`;
        }
        loadMetrics();

        // Clear form except date
        ['weight', 'waist', 'neck', 'chest', 'arms', 'thighs', 'notes'].forEach(field => {
          document.getElementById(`metric-${field}`).value = '';
        });
      }
    } catch (err) {
      console.error('Failed to save metrics:', err);
    }
  });

  // Range selector for weight chart
  document.getElementById('weight-range')?.addEventListener('change', (e) => {
    const range = e.target.value;
    let filteredData = metricsData;

    if (range !== 'all') {
      const days = parseInt(range);
      const cutoff = new Date();
      cutoff.setDate(cutoff.getDate() - days);
      filteredData = metricsData.filter(m => new Date(m.date) >= cutoff);
    }

    initWeightChart(filteredData);
  });

  // Listen for theme changes
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === 'data-theme' && metricsData.length > 0) {
        const latest = metricsData[0];
        initWeightChart(metricsData);
        initGoalsChart(latest);
        initRadarChart(latest);
      }
    });
  });
  observer.observe(document.documentElement, { attributes: true });

  // Initialize
  loadMetrics();
</script>

<style>
  .input-field {
    width: 100%;
    padding: 0.625rem 0.875rem;
    background: var(--bg-glass);
    border: 1px solid var(--border-color);
    border-radius: 0.75rem;
    color: var(--text-primary);
    font-size: 0.875rem;
    transition: all 0.2s ease;
  }

  .input-field:focus {
    outline: none;
    border-color: var(--brand-orange);
    box-shadow: 0 0 0 3px var(--brand-orange-glow);
  }

  .input-field::placeholder {
    color: var(--text-muted);
  }

  .btn-primary {
    padding: 0.75rem 1.5rem;
    background: var(--gradient-orange);
    color: white;
    font-weight: 600;
    border-radius: 0.75rem;
    transition: all 0.2s ease;
    box-shadow: 0 4px 15px var(--brand-orange-glow);
  }

  .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 20px var(--brand-orange-glow);
  }

  .btn-primary:active {
    transform: scale(0.98);
  }

  /* ApexCharts tooltip dark mode fix */
  .apexcharts-tooltip {
    background: var(--bg-card) !important;
    border: 1px solid var(--border-color) !important;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
  }

  .apexcharts-tooltip-title {
    background: var(--bg-glass) !important;
    border-bottom: 1px solid var(--border-color) !important;
  }
</style>
