---
import Layout from '../layouts/Layout.astro';
import { WORKOUTS, SCHEDULE } from '../data/workouts';

export const prerender = false;

const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
const dayLabels = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

const todayIdx = (new Date().getDay() + 6) % 7; // Convert Sunday=0 to Monday=0

const typeColors: Record<string, string> = {
  strength: 'border-l-red-500 bg-red-50',
  power: 'border-l-yellow-500 bg-yellow-50',
  hypertrophy: 'border-l-blue-500 bg-blue-50',
  speed: 'border-l-green-500 bg-green-50',
  conditioning: 'border-l-purple-500 bg-purple-50',
  rest: 'border-l-gray-300 bg-gray-50'
};
---

<Layout title="Weekly Schedule" activeNav="schedule">
  <div class="space-y-6">
    <div>
      <h1 class="text-2xl font-bold">Weekly Schedule</h1>
      <p class="text-gray-500">Your training split based on CST principles</p>
    </div>

    <div class="space-y-4">
      {days.map((day, idx) => {
        const workoutId = SCHEDULE[day];
        const workout = WORKOUTS[workoutId];
        const isToday = idx === todayIdx;

        return (
          <a
            href={`/workout?id=${workoutId}`}
            class={`block card border-l-4 ${typeColors[workout?.type || 'rest']} ${isToday ? 'ring-2 ring-brand-orange ring-offset-2' : ''} hover:shadow-md transition-shadow`}
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="text-center w-16">
                  <div class="text-xs text-gray-400 uppercase">{dayLabels[idx].slice(0, 3)}</div>
                  {isToday && <div class="text-xs text-brand-orange font-semibold">Today</div>}
                </div>
                <div>
                  <h3 class="font-semibold">{workout?.name || 'Rest'}</h3>
                  <p class="text-sm text-gray-500">{workout?.focus || 'Recovery day'}</p>
                </div>
              </div>
              <div class="text-right">
                <div class="text-sm text-gray-500">{workout?.duration || '-'}</div>
                <div class="text-xs text-gray-400 capitalize">{workout?.type || 'rest'}</div>
              </div>
            </div>
          </a>
        );
      })}
    </div>

    <!-- Training Type Legend -->
    <div class="card">
      <h3 class="font-semibold mb-4">Training Types</h3>
      <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-sm">
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full bg-red-500"></div>
          <span>Strength - Heavy loads, 4-6 reps</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
          <span>Power - Explosive movements</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full bg-blue-500"></div>
          <span>Hypertrophy - 8-12 reps, pump</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full bg-green-500"></div>
          <span>Speed - Multi-directional</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full bg-purple-500"></div>
          <span>Conditioning - Zone 2, recovery</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full bg-gray-300"></div>
          <span>Rest - Recovery is growth</span>
        </div>
      </div>
    </div>

    <!-- CST Principles -->
    <div class="card bg-gray-50">
      <h3 class="font-semibold mb-3">CST Principles</h3>
      <ul class="text-sm text-gray-600 space-y-2">
        <li>• Work in <strong>anaerobic chunks</strong>, in circuit to near metabolic threshold</li>
        <li>• Train for <strong>functional strength</strong>, not just aesthetics</li>
        <li>• Include <strong>multi-directional movement</strong> - stay lethal</li>
        <li>• <strong>Progressive overload</strong> - add 2.5-5lbs weekly on main lifts</li>
        <li>• <strong>Recovery is training</strong> - sleep 7-8 hours, hit protein</li>
      </ul>
    </div>
  </div>
</Layout>
